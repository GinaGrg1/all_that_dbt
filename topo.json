[{'type': 'default',
  'name': 'set_default_data_source',
  'columns': ['Source'],
  'value': 'EverGiving',
  'suffix': '_defaulted'},
 {'type': 'copy_columns',
  'name': 'copy_and_rename_data_source_name_column',
  'copy_columns': [{'column': 'Source_defaulted',
    'new_column_name': 'data_source_name'}],
  'depends_on': ['set_default_data_source']},
 {'type': 'concat',
  'name': 'concat_campaign_activity',
  'columns': ['Campaign', 'Operation', 'Channel'],
  'output': 'campaign_activity_external_reference'},
 {'type': 'match_to_type',
  'name': 'match_to_title_type',
  'column': 'Title',
  'parent': 'c9f71057-d6a4-ea11-a812-000d3ab395a9',
  'output': 'title_type'},
 {'type': 'match_to_optionset',
  'name': 'match_to_frequency_optionset',
  'column': 'Frequency',
  'entity': 'msnfp_donorcommitment',
  'option_set_name': 'py3_frequency',
  'output': 'frequency_optionset'},
 {'type': 'format_date',
  'name': 'formatting_date_columns',
  'columns': ['DOB', 'Starting Date', 'Bank_Date'],
  'suffix': '_as_date',
  'format': 'dd/MM/yyyy'},
 {'type': 'date_part',
  'name': 'get_starting_date',
  'column': 'Starting Date_as_date',
  'date_part': 'day',
  'output': 'starting_day',
  'depends_on': ['formatting_date_columns']},
 {'type': 'remove_characters',
  'name': 'format_sort_code',
  'column': 'S_Code',
  'characters': ['-'],
  'output': 'sort_code'},
 {'type': 'match_to_entity',
  'name': 'get_data_source_id',
  'entity': 'shl_datasource',
  'match_filters': [{'filter_on': 'shl_name',
    'filter_by_column': 'data_source_name'}],
  'output_columns': [{'column_name_in_scrm': 'shl_datasourceid',
    'output': 'data_source_id'}],
  'depends_on': ['copy_and_rename_data_source_name_column']},
 {'type': 'match_to_external_reference',
  'name': 'get_campaign_activity_id',
  'external_reference_column': 'campaign_activity_external_reference',
  'data_source_column': 'data_source_id',
  'data_source_detail': 'Campaign Operation and Channel',
  'target_entity': 'campaignactivity',
  'output': 'campaign_activity_id',
  'depends_on': ['get_data_source_id'],
  'custom_error_code': 'No Campaign Activity can be found with an external reference with the values in Campaign, Operation and Channel for this Source. Create an External Reference or Campaign Activity, or correct the values in Campaign, Operation or Channel.'},
 {'type': 'match_to_entity',
  'name': 'find_any_matching_donorcommitment',
  'entity': 'msnfp_donorcommitment',
  'match_filters': [{'filter_on': 'py3_donorcommitmentreference',
    'filter_by_column': 'GFRefNum'},
   {'filter_on': 'statecode', 'filter_by_value': 0}],
  'behaviour': {'found_none_behaviour': 'return_null'},
  'output_columns': [{'column_name_in_scrm': 'msnfp_donorcommitmentid',
    'output': 'matched_existing_donor_commitment'}]},
 {'type': 'convert_values',
  'name': 'convert_true_yes',
  'columns': ['DPAPhone', 'DPAEmail', 'DPASMS', 'GiftAid'],
  'replaces': [{'from': 'True', 'to': 'Yes'}, {'from': 'False', 'to': 'No'}],
  'behaviour': [{'if_other_values_found': 'fail_row'}],
  'suffix': '_converted'},
 {'type': 'convert_values',
  'name': 'convert_true_no',
  'columns': ['Post Opt OUT'],
  'replaces': [{'from': 'True', 'to': 'No'}, {'from': 'False', 'to': 'Yes'}],
  'behaviour': [{'if_other_values_found': 'fail_row'}],
  'suffix': '_converted'},
 {'type': 'format_post_code',
  'name': 'format_post_code',
  'columns': ['P_Code'],
  'suffix': '_formatted'},
 {'type': 'format_email_address',
  'name': 'format_email_address',
  'columns': ['Email'],
  'suffix': '_formatted'},
 {'type': 'format_phone_number',
  'name': 'format_phone_numbers',
  'columns': ['Phone Mobile', 'Phone Home'],
  'suffix': '_formatted'}]
